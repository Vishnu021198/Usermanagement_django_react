{"ast":null,"code":"import jwt_decode from \"jwt-decode\";\nimport axios from 'axios';\nconst updateUserToken = async () => {\n  const refreshToken = localStorage.getItem(\"refresh\");\n  const baseURL = 'http://127.0.0.1:8000';\n  try {\n    const res = await axios.post(baseURL + '/api/accounts/token/refresh/', {\n      'refresh': refreshToken\n    });\n    if (res.status === 200) {\n      localStorage.setItem('access', res.data.access);\n      localStorage.setItem('refresh', res.data.refresh);\n      let decoded = jwt_decode(res.data.access);\n      return {\n        'name': decoded.first_name,\n        isAuthenticated: true\n      };\n    } else {\n      return {\n        'name': null,\n        isAuthenticated: false\n      };\n    }\n  } catch (error) {\n    return {\n      'name': null,\n      isAuthenticated: false\n    };\n  }\n};\nconst isAuthUser = async () => {\n  const accessToken = localStorage.getItem(\"access\");\n  if (!accessToken) {\n    return {\n      'name': null,\n      isAuthenticated: false\n    };\n  }\n  const currentTime = Date.now() / 1000;\n  let decoded = jwt_decode(accessToken);\n  if (decoded.exp > currentTime) {\n    return {\n      'name': decoded.first_name,\n      isAuthenticated: true\n    };\n  } else {\n    const updateSuccess = await updateUserToken();\n    return updateSuccess;\n  }\n};\nexport default isAuthUser;","map":{"version":3,"names":["jwt_decode","axios","updateUserToken","refreshToken","localStorage","getItem","baseURL","res","post","status","setItem","data","access","refresh","decoded","first_name","isAuthenticated","error","isAuthUser","accessToken","currentTime","Date","now","exp","updateSuccess"],"sources":["C:/Users/nair6/Documents/Brototype/WEEK 20 - REACT/user_managemnet/frontend/src/utils/isAuthUser.js"],"sourcesContent":["\r\nimport jwt_decode from \"jwt-decode\";\r\nimport axios from 'axios'\r\n\r\nconst updateUserToken = async ()=>{\r\n    const refreshToken = localStorage.getItem(\"refresh\");\r\n    const baseURL='http://127.0.0.1:8000'\r\n\r\n    try {\r\n        const res = await axios.post(baseURL+'/api/accounts/token/refresh/', \r\n        {\r\n            'refresh':refreshToken\r\n        })\r\n        if(res.status === 200){\r\n          localStorage.setItem('access', res.data.access)\r\n          localStorage.setItem('refresh', res.data.refresh)\r\n          let decoded = jwt_decode(res.data.access);\r\n          return {'name':decoded.first_name,isAuthenticated:true}\r\n        }\r\n        else\r\n        {\r\n            return {'name':null,isAuthenticated:false}\r\n        }  \r\n        \r\n      }\r\n      catch (error) {\r\n         return {'name':null,isAuthenticated:false}\r\n      }\r\n}\r\n\r\n\r\n\r\nconst isAuthUser = async () => {\r\n\r\n    const accessToken = localStorage.getItem(\"access\");\r\n   \r\n    if(!accessToken)\r\n    {\r\n        return {'name':null,isAuthenticated:false}\r\n    }\r\n    const currentTime = Date.now() / 1000;\r\n    let decoded = jwt_decode(accessToken);\r\n    if (decoded.exp > currentTime) {\r\n        return {'name':decoded.first_name,isAuthenticated:true}\r\n      } else {\r\n        const updateSuccess = await updateUserToken();\r\n        return updateSuccess;\r\n      }\r\n\r\n\r\n\r\n}\r\nexport default isAuthUser ;"],"mappings":"AACA,OAAOA,UAAU,MAAM,YAAY;AACnC,OAAOC,KAAK,MAAM,OAAO;AAEzB,MAAMC,eAAe,GAAG,MAAAA,CAAA,KAAU;EAC9B,MAAMC,YAAY,GAAGC,YAAY,CAACC,OAAO,CAAC,SAAS,CAAC;EACpD,MAAMC,OAAO,GAAC,uBAAuB;EAErC,IAAI;IACA,MAAMC,GAAG,GAAG,MAAMN,KAAK,CAACO,IAAI,CAACF,OAAO,GAAC,8BAA8B,EACnE;MACI,SAAS,EAACH;IACd,CAAC,CAAC;IACF,IAAGI,GAAG,CAACE,MAAM,KAAK,GAAG,EAAC;MACpBL,YAAY,CAACM,OAAO,CAAC,QAAQ,EAAEH,GAAG,CAACI,IAAI,CAACC,MAAM,CAAC;MAC/CR,YAAY,CAACM,OAAO,CAAC,SAAS,EAAEH,GAAG,CAACI,IAAI,CAACE,OAAO,CAAC;MACjD,IAAIC,OAAO,GAAGd,UAAU,CAACO,GAAG,CAACI,IAAI,CAACC,MAAM,CAAC;MACzC,OAAO;QAAC,MAAM,EAACE,OAAO,CAACC,UAAU;QAACC,eAAe,EAAC;MAAI,CAAC;IACzD,CAAC,MAED;MACI,OAAO;QAAC,MAAM,EAAC,IAAI;QAACA,eAAe,EAAC;MAAK,CAAC;IAC9C;EAEF,CAAC,CACD,OAAOC,KAAK,EAAE;IACX,OAAO;MAAC,MAAM,EAAC,IAAI;MAACD,eAAe,EAAC;IAAK,CAAC;EAC7C;AACN,CAAC;AAID,MAAME,UAAU,GAAG,MAAAA,CAAA,KAAY;EAE3B,MAAMC,WAAW,GAAGf,YAAY,CAACC,OAAO,CAAC,QAAQ,CAAC;EAElD,IAAG,CAACc,WAAW,EACf;IACI,OAAO;MAAC,MAAM,EAAC,IAAI;MAACH,eAAe,EAAC;IAAK,CAAC;EAC9C;EACA,MAAMI,WAAW,GAAGC,IAAI,CAACC,GAAG,CAAC,CAAC,GAAG,IAAI;EACrC,IAAIR,OAAO,GAAGd,UAAU,CAACmB,WAAW,CAAC;EACrC,IAAIL,OAAO,CAACS,GAAG,GAAGH,WAAW,EAAE;IAC3B,OAAO;MAAC,MAAM,EAACN,OAAO,CAACC,UAAU;MAACC,eAAe,EAAC;IAAI,CAAC;EACzD,CAAC,MAAM;IACL,MAAMQ,aAAa,GAAG,MAAMtB,eAAe,CAAC,CAAC;IAC7C,OAAOsB,aAAa;EACtB;AAIN,CAAC;AACD,eAAeN,UAAU"},"metadata":{},"sourceType":"module","externalDependencies":[]}